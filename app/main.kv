#:kivy 1.10.0
#:set default_font_size "40sp"

<ScreenManagement>: 
    MainScreen:

    KeyinScreen:
   
    LoadScreen:
        
    UnlockScreen:

    RestScreen: 
        
	
<MainScreen>:
    name: 'main'
    canvas.before:
        Rectangle: 
            pos: self.pos
            size: self.size
            source: app.load_resource('background.png')
        
    FloatLayout:
        Image: 
            size_hint: (.2, .2)
            pos_hint: {'center_x': .5, 'center_y': .8}
            source: app.load_resource('logo.png')
        FloatLayout:
            size_hint: 0.7, 0.3
            pos_hint: {'center_x': .5, 'center_y': .4}
            RoundedButton:
                on_press: root.manager.current = 'load'
                size_hint: 0.3, 0.7
                pos_hint: {'center_x': .3, 'center_y': .8}
                Label: 
                    text: 'Load'
                    color: 0,0,0,1
                    x: self.parent.x + 70
                    y: self.parent.y 
                Image: 
                    source: app.load_resource('trolley.png')
                    allow_stretch: True
                    width: 50
                    pos: self.parent.x + 35, self.parent.height + 80
            RoundedButton:
                on_press: root.manager.current = 'unlock'
                size_hint: 0.3, 0.7
                pos_hint: {'center_x': .7, 'center_y': .8}
                Label: 
                    text: 'Unlock'
                    color: 0,0,0,1
                    x: self.parent.x + 70
                    y: self.parent.y 
                Image: 
                    source: app.load_resource('padlock.png')
                    width: 50
                    allow_stretch: True
                    pos: self.parent.x + 35, self.parent.height + 85

<LoadScreen>:
    name: 'load'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        RoundedLabel: 
            text: 'Load your parcels'
            font_size: 20
            size_hint: 1, 0.1
        KivyCamera:
            id: scanner
            size_hint: 1, 0.7
        BoxLayout: 
            size_hint: 1, 0.2
            padding: 10
            spacing: 100
            RoundedButton: 
                text: 'End scanning'
                on_release: root.exit_scan()

<KeyinScreen>:
    name: 'keyin'
    FloatLayout:
        RoundedLabel:
            text: "Check your SMS for a 9-digit number"
            size_hint: (.7, .1)
            pos_hint: {'center_x': .5, 'center_y': .9}
        TextInput: 
            size_hint: (.5, .1)
            pos_hint: {'center_x': .5, 'center_y': .6}
            id: id
            input_type: 'number'
            hint_text: "Enter here"
            multiline: False
        RoundedButton: 
            size_hint: (.3, .1)
            pos_hint: {'center_x': .5, 'center_y': .4}
            border: 30,30,30,30
            text: 'Unlock'
            font_size: 18
            on_press: root.unlock(id.text)
        BorderlessButton: 
            size_hint: 0.2, 0.1
            pos_hint: {'center_x': .9, 'center_y': .2}
            text: 'Back to home'
            on_press: root.exit_scan()
        

<UnlockScreen>:
    name: 'unlock'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        RoundedLabel: 
            text: 'Scan the QR code in the SMS you received to unlock your parcel!'
            font_size: 15
            size_hint: 1, 0.1
        KivyCamera:
            id: scanner
            size_hint: 1, 0.7
        FloatLayout:
            size_hint: 1, 0.2
            RoundedButton: 
                size_hint: 0.5, 0.7
                pos_hint: {'center_x': .5, 'center_y': .6}
                text: 'Can\'t scan? Input the details from your SMS!'
                on_press: root.manager.current = 'keyin'
            BorderlessButton: 
                size_hint: 0.5, 0.2
                pos_hint: {'center_x': .9, 'center_y': .1}
                text: 'Back to home'
                on_press: root.exit_scan()

<RestScreen>:
    name: 'rest'
    canvas.before:
        Rectangle: 
            pos: self.pos
            size: self.size
            source: app.load_resource('background.png')

    FloatLayout: 
        Image: 
            size_hint: (.2, .2)
            pos_hint: {'center_x': .5, 'center_y': .8}
            source: app.load_resource('logo.png')
        RoundedButton:
            on_press: root.manager.current = 'unlock'
            size_hint: (.3, .3)
            pos_hint: {'center_x': .5, 'center_y': .4}
            Label: 
                text: 'Unlock your parcel!'
                color: 0,0,0,1
                x: self.parent.x + 70
                y: self.parent.y 
            Image: 
                source: app.load_resource('padlock.png')
                width: 50
                allow_stretch: True
                pos: self.parent.x + 35, self.parent.height + 85
            

                

<RoundedLabel@Label>:
    background_color: 0,0,0,0
    canvas.before:
        Color: 
            rgba: (1,.6,0,1)
        RoundedRectangle: 
            pos: self.pos
            size: self.size
            radius: [30,]

<RoundedButton@Button>:
    background_normal: app.load_resource('buttonnorm.png')
    background_down: app.load_resource('buttondown.png')

<BorderlessButton@Button>:
    background_color: 0,0,0,0
    color: 1,.6,0,1

<Popup>:
    title_color: 1,.6,0,1
    title_size: 17
    title_align: 'center'
    background: app.load_resource('popup.png')
